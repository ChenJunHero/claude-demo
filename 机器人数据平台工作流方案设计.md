# æœºå™¨äººæ•°æ®å¹³å°å·¥ä½œæµæ–¹æ¡ˆè®¾è®¡æ–‡æ¡£

## æ–‡æ¡£ç‰ˆæœ¬
- ç‰ˆæœ¬å·ï¼šv1.0
- åˆ›å»ºæ—¥æœŸï¼š2025-10-10
- æ–‡æ¡£çŠ¶æ€ï¼šåˆç¨¿

---

## ç›®å½•
1. [éœ€æ±‚åˆ†æ](#1-éœ€æ±‚åˆ†æ)
2. [Dify å¯è¡Œæ€§åˆ†æ](#2-dify-å¯è¡Œæ€§åˆ†æ)
3. [æ¨èæ–¹æ¡ˆå¯¹æ¯”](#3-æ¨èæ–¹æ¡ˆå¯¹æ¯”)
4. [æ–¹æ¡ˆè¯¦ç»†è¯´æ˜](#4-æ–¹æ¡ˆè¯¦ç»†è¯´æ˜)
5. [æœ€ç»ˆæ¨èæ–¹æ¡ˆï¼šn8n](#5-æœ€ç»ˆæ¨èæ–¹æ¡ˆn8n)
6. [å®æ–½æ–¹æ¡ˆ](#6-å®æ–½æ–¹æ¡ˆ)
7. [å®Œæ•´ç¤ºä¾‹](#7-å®Œæ•´ç¤ºä¾‹)
8. [æ€»ç»“ä¸å»ºè®®](#8-æ€»ç»“ä¸å»ºè®®)

---

## 1. éœ€æ±‚åˆ†æ

### 1.1 ä¸šåŠ¡èƒŒæ™¯
- **å…¬å¸ä¸šåŠ¡**ï¼šæœºå™¨äººæ•°æ®å¹³å°
- **æ•°æ®æ¥æº**ï¼šé‡‡é›†çš„æ–‡ä»¶æ•°æ®å­˜å‚¨åœ¨é˜¿é‡Œäº‘ OSS
- **æ ¸å¿ƒéœ€æ±‚**ï¼šå¯è§†åŒ–çš„æ•°æ®å¤„ç†æµç¨‹ç®¡ç†

### 1.2 åŠŸèƒ½éœ€æ±‚

#### æ ¸å¿ƒåŠŸèƒ½
1. **æ•°æ®è¯»å–**
   - ä»é˜¿é‡Œäº‘ OSS è¯»å–æ–‡ä»¶
   - æ”¯æŒå¤šç§æ–‡ä»¶æ ¼å¼ï¼ˆJSONã€CSVã€äºŒè¿›åˆ¶ç­‰ï¼‰

2. **æ•°æ®å¤„ç†**
   - å¼€å‘è€…å¯ç¼–å†™è‡ªå®šä¹‰è„šæœ¬
   - æ”¯æŒ Pythonã€JavaScript ç­‰è¯­è¨€
   - æ•°æ®æ ¼å¼è½¬æ¢å’Œå¤„ç†

3. **æ•°æ®è¾“å‡º**
   - é€šè¿‡ HTTP èŠ‚ç‚¹å‘é€æ•°æ®
   - æ”¯æŒå¤šä¸ªç›®æ ‡ç«¯ç‚¹
   - æ•°æ®ä¼ è¾“åˆ°æŒ‡å®šç¯èŠ‚

4. **å·¥ä½œæµç¼–æ’**
   - å¯è§†åŒ–æ‹–æ‹½å¼ç¼–è¾‘
   - èŠ‚ç‚¹è¿æ¥å’Œæµç¨‹è®¾è®¡
   - ä»»åŠ¡è°ƒåº¦å’Œæ‰§è¡Œ

5. **å¹³å°é›†æˆ**
   - å†…åµŒåˆ°ç°æœ‰æ•°æ®å¹³å°
   - ä¸å¹³å°æ— ç¼é›†æˆ
   - ç»Ÿä¸€çš„ç”¨æˆ·ä½“éªŒ

### 1.3 æŠ€æœ¯éœ€æ±‚

```
æ•°æ®æµç¨‹ï¼š
é˜¿é‡Œäº‘ OSS â†’ è¯»å–èŠ‚ç‚¹ â†’ è„šæœ¬å¤„ç† â†’ æ ¼å¼è½¬æ¢ â†’ HTTP å‘é€ â†’ ç›®æ ‡ç³»ç»Ÿ

æŠ€æœ¯è¦æ±‚ï¼š
- å¯è§†åŒ–ç¼–è¾‘å™¨
- REST API æ”¯æŒ
- å¯åµŒå…¥å¼æ¶æ„
- è‡ªå®šä¹‰è„šæœ¬æ”¯æŒ
- ä»»åŠ¡è°ƒåº¦èƒ½åŠ›
- æ—¥å¿—ç›‘æ§
```

---

## 2. Dify å¯è¡Œæ€§åˆ†æ

### 2.1 Dify ç®€ä»‹

Dify æ˜¯ä¸€ä¸ªå¼€æºçš„ LLM åº”ç”¨å¼€å‘å¹³å°ï¼Œä¸»è¦ç”¨äºæ„å»º AI åº”ç”¨å’Œæ™ºèƒ½ä½“ã€‚

**æ ¸å¿ƒåŠŸèƒ½**ï¼š
- Chatflowï¼šå¯¹è¯å¼åº”ç”¨
- Workflowï¼šè‡ªåŠ¨åŒ–æµç¨‹
- ä»£ç èŠ‚ç‚¹ã€IF/ELSE èŠ‚ç‚¹ã€è¿­ä»£èŠ‚ç‚¹
- HTTP è¯·æ±‚èŠ‚ç‚¹

### 2.2 é€‚ç”¨æ€§åˆ†æ

#### âœ… Dify çš„ä¼˜åŠ¿
- å¯è§†åŒ–å·¥ä½œæµç¼–è¾‘
- æ”¯æŒä»£ç èŠ‚ç‚¹
- HTTP è¯·æ±‚èŠ‚ç‚¹
- å®šæ—¶å’Œäº‹ä»¶è§¦å‘

#### âŒ Dify çš„å±€é™æ€§

1. **å®šä½ä¸åŒ¹é…**
   - ä¸»è¦é¢å‘ LLM åº”ç”¨å¼€å‘ï¼ˆAI Agentã€å¯¹è¯æœºå™¨äººï¼‰
   - ä¸æ˜¯ä¸“é—¨çš„æ•°æ®å¤„ç†å·¥ä½œæµå¼•æ“

2. **æ•°æ®å¤„ç†èƒ½åŠ›æœ‰é™**
   - ç¼ºå°‘åŸç”Ÿçš„æ–‡ä»¶ç³»ç»Ÿé›†æˆ
   - æ²¡æœ‰ OSS è¯»å–çš„åŸç”Ÿæ”¯æŒ
   - æ‰¹é‡æ•°æ®å¤„ç†èƒ½åŠ›è¾ƒå¼±

3. **å†…åµŒé›†æˆå›°éš¾**
   - å†…åµŒèƒ½åŠ›æœ‰é™
   - API ä¸å¤Ÿå®Œå–„
   - éš¾ä»¥ç™½æ ‡åŒ–é›†æˆ

4. **æ‰©å±•æ€§é—®é¢˜**
   - è‡ªå®šä¹‰èŠ‚ç‚¹å¼€å‘å›°éš¾
   - æ’ä»¶ç”Ÿæ€ä¸æˆç†Ÿ
   - ç¤¾åŒºä¸»è¦å…³æ³¨ AI åœºæ™¯

### 2.3 ç»“è®º

**Dify ä¸é€‚åˆä½œä¸ºæ•°æ®å¹³å°çš„å·¥ä½œæµå¼•æ“**

æ¨èåŸå› ï¼š
- âŒ æ ¸å¿ƒå®šä½ä¸ç¬¦ï¼ˆAI åº”ç”¨ vs æ•°æ®å¤„ç†ï¼‰
- âŒ æ•°æ®å¤„ç†èƒ½åŠ›ä¸è¶³
- âŒ å†…åµŒé›†æˆèƒ½åŠ›æœ‰é™
- âŒ OSS é›†æˆéœ€è¦å¤§é‡å®šåˆ¶

---

## 3. æ¨èæ–¹æ¡ˆå¯¹æ¯”

### 3.1 å¯å†…åµŒå·¥ä½œæµå¼•æ“å¯¹æ¯”è¡¨

| æ–¹æ¡ˆ | å¯è§†åŒ–ç¼–è¾‘ | å†…åµŒéš¾åº¦ | æŠ€æœ¯æ ˆ | è®¸å¯è¯ | ç¤¾åŒºæ´»è·ƒåº¦ | å­¦ä¹ æ›²çº¿ | é€‚åˆåœºæ™¯ |
|------|-----------|---------|--------|--------|-----------|---------|---------|
| **n8n** | â­â­â­â­â­ æ‹–æ‹½å¼ | â­â­â­â­â­ æç®€å• | Node.js | Fair-code | â­â­â­â­â­ | ä½ | å¿«é€Ÿå†…åµŒï¼Œä½ä»£ç  |
| **Argo Workflows** | â­â­â­ YAML+UI | â­â­â­â­ ä¸­ç­‰ | Go | Apache 2.0 | â­â­â­â­â­ | ä¸­ | Kubernetes åŸç”Ÿ |
| **Windmill** | â­â­â­â­ æ··åˆæ¨¡å¼ | â­â­â­â­ ä¸­ç­‰ | Rust/TS | AGPLv3 | â­â­â­â­ | ä¸­ | å¼€å‘è€…å‹å¥½ |
| **Temporal** | â­â­ çº¯ä»£ç  | â­â­â­ å¤æ‚ | Go/Python/Java | MIT | â­â­â­â­â­ | é«˜ | ä¼ä¸šçº§å¯é æ€§ |
| **Prefect** | â­â­â­ æœ‰é™å¯è§†åŒ– | â­â­â­â­ ä¸­ç­‰ | Python | Apache 2.0 | â­â­â­â­ | ä¸­ | æ•°æ®å·¥ç¨‹ |
| **Apache Airflow** | â­â­â­ ç›‘æ§ä¸ºä¸» | â­â­ å›°éš¾ | Python | Apache 2.0 | â­â­â­â­â­ | é«˜ | å¤§æ•°æ®å¤„ç† |
| **Apache NiFi** | â­â­â­â­â­ æ‹–æ‹½å¼ | â­â­ å›°éš¾ | Java | Apache 2.0 | â­â­â­â­ | é«˜ | ä¼ä¸šæ•°æ®æµ |

### 3.2 è¯¦ç»†è¯„åˆ†

#### n8nï¼ˆæ€»åˆ†ï¼š95/100ï¼‰
- å¯è§†åŒ–ç¼–è¾‘ï¼š20/20
- å†…åµŒé›†æˆï¼š20/20
- å¼€å‘ä½“éªŒï¼š18/20
- æ€§èƒ½è¡¨ç°ï¼š15/20
- ç”Ÿæ€ä¸°å¯Œåº¦ï¼š22/20

#### Argo Workflowsï¼ˆæ€»åˆ†ï¼š86/100ï¼‰
- å¯è§†åŒ–ç¼–è¾‘ï¼š12/20
- å†…åµŒé›†æˆï¼š17/20
- å¼€å‘ä½“éªŒï¼š17/20
- æ€§èƒ½è¡¨ç°ï¼š19/20
- ç”Ÿæ€ä¸°å¯Œåº¦ï¼š21/20

#### Windmillï¼ˆæ€»åˆ†ï¼š88/100ï¼‰
- å¯è§†åŒ–ç¼–è¾‘ï¼š18/20
- å†…åµŒé›†æˆï¼š18/20
- å¼€å‘ä½“éªŒï¼š19/20
- æ€§èƒ½è¡¨ç°ï¼š18/20
- ç”Ÿæ€ä¸°å¯Œåº¦ï¼š15/20

#### Temporalï¼ˆæ€»åˆ†ï¼š85/100ï¼‰
- å¯è§†åŒ–ç¼–è¾‘ï¼š8/20
- å†…åµŒé›†æˆï¼š15/20
- å¼€å‘ä½“éªŒï¼š18/20
- æ€§èƒ½è¡¨ç°ï¼š20/20
- ç”Ÿæ€ä¸°å¯Œåº¦ï¼š24/20

#### Prefectï¼ˆæ€»åˆ†ï¼š82/100ï¼‰
- å¯è§†åŒ–ç¼–è¾‘ï¼š12/20
- å†…åµŒé›†æˆï¼š16/20
- å¼€å‘ä½“éªŒï¼š18/20
- æ€§èƒ½è¡¨ç°ï¼š18/20
- ç”Ÿæ€ä¸°å¯Œåº¦ï¼š18/20

---

## 4. æ–¹æ¡ˆè¯¦ç»†è¯´æ˜

### 4.1 æ–¹æ¡ˆ1ï¼šn8nï¼ˆæœ€æ¨è â­â­â­â­â­ï¼‰

#### 4.1.1 äº§å“ä»‹ç»

n8n æ˜¯ä¸€ä¸ªå¼€æºçš„å·¥ä½œæµè‡ªåŠ¨åŒ–å·¥å…·ï¼Œæä¾›å¯è§†åŒ–çš„èŠ‚ç‚¹ç¼–æ’ç•Œé¢ã€‚

**å®˜ç½‘**ï¼šhttps://n8n.io/
**GitHub**ï¼šhttps://github.com/n8n-io/n8n
**Star æ•°**ï¼š45k+

#### 4.1.2 æ ¸å¿ƒä¼˜åŠ¿

**1. å®Œå…¨å¯å†…åµŒ**
- æä¾› Embed Licenseï¼Œæ”¯æŒç™½æ ‡é›†æˆ
- iframe åµŒå…¥ç¼–è¾‘å™¨
- REST API å®Œå…¨å¯æ§
- å¯ä»¥éšè— n8n å“ç‰Œ

**2. å¯è§†åŒ–ç¼–è¾‘**
- æ‹–æ‹½å¼èŠ‚ç‚¹è¿æ¥
- å®æ—¶æµ‹è¯•æ¯ä¸ªèŠ‚ç‚¹
- å¯è§†åŒ–æ•°æ®æµ
- ç›´è§‚çš„è°ƒè¯•ç•Œé¢

**3. ä¸°å¯Œçš„èŠ‚ç‚¹åº“**
- 400+ å†…ç½®é›†æˆ
- HTTP Request èŠ‚ç‚¹
- Code èŠ‚ç‚¹ï¼ˆJavaScript/Pythonï¼‰
- æ•°æ®è½¬æ¢èŠ‚ç‚¹
- æ–‡ä»¶å¤„ç†èŠ‚ç‚¹

**4. æ˜“äºæ‰©å±•**
- è‡ªå®šä¹‰èŠ‚ç‚¹å¼€å‘ç®€å•
- ç¤¾åŒºæ´»è·ƒï¼Œæ’ä»¶ä¸°å¯Œ
- å¯ä»¥åˆ›å»º OSS èŠ‚ç‚¹

**5. éƒ¨ç½²ç®€å•**
- Docker ä¸€é”®éƒ¨ç½²
- æ”¯æŒè‡ªæ‰˜ç®¡
- èµ„æºå ç”¨ä½

#### 4.1.3 é›†æˆæ–¹å¼

**æ–¹å¼1ï¼šiframe åµŒå…¥ç¼–è¾‘å™¨**
```html
<iframe
  src="http://your-n8n-instance/workflow/new"
  width="100%"
  height="800px"
></iframe>
```

**æ–¹å¼2ï¼šREST API è°ƒç”¨**
```javascript
// åˆ›å»ºå·¥ä½œæµ
fetch('http://your-n8n-instance/api/v1/workflows', {
  method: 'POST',
  headers: {
    'X-N8N-API-KEY': 'your-api-key',
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    name: 'Robot Data Pipeline',
    nodes: [...],
    connections: {...}
  })
})

// æ‰§è¡Œå·¥ä½œæµ
fetch('http://your-n8n-instance/api/v1/workflows/{id}/execute', {
  method: 'POST',
  body: JSON.stringify({ data: {...} })
})
```

**æ–¹å¼3ï¼šWebhook è§¦å‘**
```bash
curl -X POST \
  http://your-n8n-instance/webhook/your-workflow-id \
  -H 'Content-Type: application/json' \
  -d '{"ossPath": "bucket/data.json"}'
```

#### 4.1.4 æŠ€æœ¯æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æ‚¨çš„æ•°æ®å¹³å°ï¼ˆå‰ç«¯ï¼‰                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  å·¥ä½œæµç®¡ç†é¡µé¢                      â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚   â”‚
â”‚  â”‚  â”‚ n8n ç¼–è¾‘å™¨ (iframe)          â”‚   â”‚   â”‚
â”‚  â”‚  â”‚  [OSS] â†’ [è„šæœ¬] â†’ [HTTP]     â”‚   â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚   â”‚
â”‚  â”‚  [ä¿å­˜] [æ‰§è¡Œ] [æ—¥å¿—]               â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“ REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         n8n åç«¯æœåŠ¡                         â”‚
â”‚  - å·¥ä½œæµå¼•æ“                                â”‚
â”‚  - ä»»åŠ¡è°ƒåº¦å™¨                                â”‚
â”‚  - æ—¥å¿—ç³»ç»Ÿ                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.1.5 ä¼˜ç¼ºç‚¹æ€»ç»“

**ä¼˜ç‚¹**ï¼š
- âœ… çœŸæ­£çš„å¯è§†åŒ–ç¼–è¾‘ï¼Œäº§å“ç»ç†ä¹Ÿèƒ½ç”¨
- âœ… å†…åµŒé›†æˆæœ€ç®€å•
- âœ… å¼€æºå…è´¹ï¼ˆFair-code è®¸å¯ï¼‰
- âœ… èŠ‚ç‚¹ä¸°å¯Œï¼Œæ˜“æ‰©å±•
- âœ… ç¤¾åŒºæ´»è·ƒï¼Œæ–‡æ¡£å®Œå–„
- âœ… éƒ¨ç½²ç®€å•ï¼Œç»´æŠ¤æˆæœ¬ä½

**ç¼ºç‚¹**ï¼š
- âš ï¸ å¤§è§„æ¨¡å¹¶å‘æ€§èƒ½ä¸€èˆ¬ï¼ˆå¯é€šè¿‡é›†ç¾¤è§£å†³ï¼‰
- âš ï¸ Fair-code è®¸å¯ï¼Œå•†ä¸šä½¿ç”¨éœ€æ³¨æ„
- âš ï¸ OSS èŠ‚ç‚¹éœ€è¦è‡ªå·±å¼€å‘

---

### 4.2 æ–¹æ¡ˆ2ï¼šArgo Workflowsï¼ˆKubernetes åŸç”Ÿ â­â­â­â­ï¼‰

#### 4.2.1 äº§å“ä»‹ç»

Argo Workflows æ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨åŸç”Ÿå·¥ä½œæµå¼•æ“ï¼Œç”¨äºåœ¨ Kubernetes ä¸Šç¼–æ’å¹¶è¡Œä½œä¸šã€‚

**å®˜ç½‘**ï¼šhttps://argoproj.github.io/workflows/
**GitHub**ï¼šhttps://github.com/argoproj/argo-workflows
**Star æ•°**ï¼š15k+
**CNCF çŠ¶æ€**ï¼šæ¯•ä¸šé¡¹ç›®

#### 4.2.2 æ ¸å¿ƒä¼˜åŠ¿

**1. Kubernetes åŸç”Ÿ**
- å®Œå…¨ä¸º Kubernetes è®¾è®¡
- æ¯ä¸ªå·¥ä½œæµæ­¥éª¤åœ¨ç‹¬ç«‹çš„å®¹å™¨ä¸­è¿è¡Œ
- å¤©ç„¶æ”¯æŒå®¹å™¨åŒ–åº”ç”¨
- ä¸ K8s ç”Ÿæ€æ·±åº¦é›†æˆ

**2. DAG å·¥ä½œæµ**
- æ”¯æŒå¤æ‚çš„æœ‰å‘æ— ç¯å›¾ï¼ˆDAGï¼‰
- å¹¶è¡Œæ‰§è¡Œä¼˜åŒ–
- æ¡ä»¶åˆ†æ”¯å’Œå¾ªç¯
- å·¥ä½œæµæ¨¡æ¿å¤ç”¨

**3. å¯è§†åŒ– UI**
- å†…ç½® Web UI
- å®æ—¶æŸ¥çœ‹å·¥ä½œæµæ‰§è¡ŒçŠ¶æ€
- æ—¥å¿—æŸ¥çœ‹å’Œè°ƒè¯•
- å·¥ä½œæµå®šä¹‰å¯è§†åŒ–

**4. ä¼ä¸šçº§ç‰¹æ€§**
- å¤§è§„æ¨¡å¹¶å‘å¤„ç†
- èµ„æºé…é¢ç®¡ç†
- å¤šç§Ÿæˆ·æ”¯æŒ
- RBAC æƒé™æ§åˆ¶

**5. ä¸°å¯Œçš„ç”Ÿæ€**
- Argo CDï¼ˆGitOps éƒ¨ç½²ï¼‰
- Argo Rolloutsï¼ˆæ¸è¿›å¼äº¤ä»˜ï¼‰
- Argo Eventsï¼ˆäº‹ä»¶é©±åŠ¨ï¼‰
- å®Œæ•´çš„ Argo ç”Ÿæ€ç³»ç»Ÿ

#### 4.2.3 å·¥ä½œæµå®šä¹‰

**YAML ç¤ºä¾‹**ï¼š
```yaml
apiVersion: argoproj.io/v1alpha1
kind: Workflow
metadata:
  generateName: robot-data-pipeline-
spec:
  entrypoint: main-dag

  # å®šä¹‰å·¥ä½œæµæ¨¡æ¿
  templates:

  # ä¸» DAG
  - name: main-dag
    dag:
      tasks:
      # 1. ä» OSS è¯»å–æ•°æ®
      - name: read-oss
        template: oss-reader
        arguments:
          parameters:
          - name: oss-path
            value: "sensors/{{workflow.creationTimestamp.Y}}-{{workflow.creationTimestamp.m}}-{{workflow.creationTimestamp.d}}.json"

      # 2. æ•°æ®è½¬æ¢
      - name: transform-data
        template: data-transformer
        dependencies: [read-oss]
        arguments:
          parameters:
          - name: input-data
            value: "{{tasks.read-oss.outputs.result}}"

      # 3. å‘é€ HTTP è¯·æ±‚
      - name: send-http
        template: http-sender
        dependencies: [transform-data]
        arguments:
          parameters:
          - name: data
            value: "{{tasks.transform-data.outputs.result}}"

  # OSS è¯»å–æ¨¡æ¿
  - name: oss-reader
    inputs:
      parameters:
      - name: oss-path
    container:
      image: python:3.9-slim
      command: [python]
      args:
        - -c
        - |
          import oss2
          import json
          import os

          # ä»ç¯å¢ƒå˜é‡è·å–å‡­è¯
          access_key_id = os.environ['OSS_ACCESS_KEY_ID']
          access_key_secret = os.environ['OSS_ACCESS_KEY_SECRET']
          bucket_name = os.environ['OSS_BUCKET']
          endpoint = os.environ['OSS_ENDPOINT']

          # åˆ›å»º OSS å®¢æˆ·ç«¯
          auth = oss2.Auth(access_key_id, access_key_secret)
          bucket = oss2.Bucket(auth, endpoint, bucket_name)

          # è¯»å–æ–‡ä»¶
          oss_path = "{{inputs.parameters.oss-path}}"
          obj = bucket.get_object(oss_path)
          data = obj.read().decode('utf-8')

          # è¾“å‡ºæ•°æ®
          print(data)
      env:
      - name: OSS_ACCESS_KEY_ID
        valueFrom:
          secretKeyRef:
            name: oss-credentials
            key: access-key-id
      - name: OSS_ACCESS_KEY_SECRET
        valueFrom:
          secretKeyRef:
            name: oss-credentials
            key: access-key-secret
      - name: OSS_BUCKET
        value: "robot-data-bucket"
      - name: OSS_ENDPOINT
        value: "oss-cn-hangzhou.aliyuncs.com"

  # æ•°æ®è½¬æ¢æ¨¡æ¿
  - name: data-transformer
    inputs:
      parameters:
      - name: input-data
    script:
      image: python:3.9-slim
      command: [python]
      source: |
        import json
        import sys

        # è¯»å–è¾“å…¥æ•°æ®
        input_data = '''{{inputs.parameters.input-data}}'''
        data = json.loads(input_data)

        # æ•°æ®è½¬æ¢é€»è¾‘
        transformed = {
            "robot_id": data.get("id"),
            "sensors": data.get("sensors"),
            "timestamp": data.get("timestamp"),
            "processed_at": "{{workflow.creationTimestamp}}"
        }

        # è¾“å‡ºè½¬æ¢åçš„æ•°æ®
        print(json.dumps(transformed))

  # HTTP å‘é€æ¨¡æ¿
  - name: http-sender
    inputs:
      parameters:
      - name: data
    container:
      image: curlimages/curl:latest
      command: [sh, -c]
      args:
        - |
          curl -X POST https://api.example.com/data \
            -H "Content-Type: application/json" \
            -H "Authorization: Bearer {{workflow.parameters.api-token}}" \
            -d '{{inputs.parameters.data}}'
```

#### 4.2.4 é›†æˆæ–¹å¼

**1. é€šè¿‡ Kubernetes API**
```python
from kubernetes import client, config
import yaml

# åŠ è½½ Kubernetes é…ç½®
config.load_kube_config()

# åˆ›å»º Argo Workflows API å®¢æˆ·ç«¯
api = client.CustomObjectsApi()

# å®šä¹‰å·¥ä½œæµ
workflow_manifest = {
    "apiVersion": "argoproj.io/v1alpha1",
    "kind": "Workflow",
    "metadata": {
        "generateName": "robot-data-pipeline-"
    },
    "spec": {
        # ... å·¥ä½œæµå®šä¹‰
    }
}

# æäº¤å·¥ä½œæµ
api.create_namespaced_custom_object(
    group="argoproj.io",
    version="v1alpha1",
    namespace="default",
    plural="workflows",
    body=workflow_manifest
)
```

**2. é€šè¿‡ Argo CLI**
```bash
# æäº¤å·¥ä½œæµ
argo submit workflow.yaml

# åˆ—å‡ºå·¥ä½œæµ
argo list

# æŸ¥çœ‹å·¥ä½œæµçŠ¶æ€
argo get robot-data-pipeline-xxxxx

# æŸ¥çœ‹æ—¥å¿—
argo logs robot-data-pipeline-xxxxx

# åˆ é™¤å·¥ä½œæµ
argo delete robot-data-pipeline-xxxxx
```

**3. é€šè¿‡ Argo Server API**
```typescript
// ä½¿ç”¨ REST API
import axios from 'axios';

const argoServerUrl = 'https://argo-server.example.com';
const namespace = 'default';

// åˆ›å»ºå·¥ä½œæµ
async function submitWorkflow(workflowSpec: any) {
    const response = await axios.post(
        `${argoServerUrl}/api/v1/workflows/${namespace}`,
        {
            workflow: workflowSpec
        },
        {
            headers: {
                'Authorization': `Bearer ${process.env.ARGO_TOKEN}`
            }
        }
    );

    return response.data;
}

// è·å–å·¥ä½œæµçŠ¶æ€
async function getWorkflow(workflowName: string) {
    const response = await axios.get(
        `${argoServerUrl}/api/v1/workflows/${namespace}/${workflowName}`,
        {
            headers: {
                'Authorization': `Bearer ${process.env.ARGO_TOKEN}`
            }
        }
    );

    return response.data;
}
```

**4. åµŒå…¥ Argo UI**
```html
<!-- åœ¨æ‚¨çš„å¹³å°ä¸­åµŒå…¥ Argo UI -->
<iframe
    src="https://argo-server.example.com/workflows/default/robot-data-pipeline-xxxxx"
    width="100%"
    height="800px"
    frameborder="0"
></iframe>
```

#### 4.2.5 æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       æ‚¨çš„æ•°æ®å¹³å°ï¼ˆå‰ç«¯ï¼‰                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  å·¥ä½œæµç®¡ç†                          â”‚    â”‚
â”‚  â”‚  - åˆ›å»ºå·¥ä½œæµï¼ˆYAML ç¼–è¾‘å™¨ï¼‰         â”‚    â”‚
â”‚  â”‚  - æŸ¥çœ‹å·¥ä½œæµåˆ—è¡¨                    â”‚    â”‚
â”‚  â”‚  - åµŒå…¥ Argo UI (iframe)            â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“ REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       æ‚¨çš„å¹³å°åç«¯                            â”‚
â”‚  - å·¥ä½œæµ YAML ç”Ÿæˆ                           â”‚
â”‚  - è°ƒç”¨ Kubernetes API                       â”‚
â”‚  - æƒé™æ§åˆ¶                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“ Kubernetes API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Kubernetes é›†ç¾¤                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚    Argo Workflows Controller         â”‚    â”‚
â”‚  â”‚  - ç›‘å¬ Workflow CRD                 â”‚    â”‚
â”‚  â”‚  - åˆ›å»º Pod æ‰§è¡Œä»»åŠ¡                 â”‚    â”‚
â”‚  â”‚  - ç®¡ç†å·¥ä½œæµç”Ÿå‘½å‘¨æœŸ                â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚    Argo Server (API + UI)            â”‚    â”‚
â”‚  â”‚  - REST API                          â”‚    â”‚
â”‚  â”‚  - Web UI                            â”‚    â”‚
â”‚  â”‚  - SSO é›†æˆ                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚    Workflow Pods                     â”‚    â”‚
â”‚  â”‚  - OSS Reader Pod                    â”‚    â”‚
â”‚  â”‚  - Data Transformer Pod              â”‚    â”‚
â”‚  â”‚  - HTTP Sender Pod                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4.2.6 ä¼˜ç¼ºç‚¹æ€»ç»“

**ä¼˜ç‚¹**ï¼š
- âœ… Kubernetes åŸç”Ÿï¼Œå®¹å™¨åŒ–å‹å¥½
- âœ… é«˜æ€§èƒ½å¹¶å‘å¤„ç†
- âœ… CNCF æ¯•ä¸šé¡¹ç›®ï¼Œç”Ÿæ€æˆç†Ÿ
- âœ… æ”¯æŒå¤æ‚çš„ DAG å·¥ä½œæµ
- âœ… å†…ç½® UIï¼Œå¯è§†åŒ–ç›‘æ§
- âœ… ä¸ CI/CD é›†æˆè‰¯å¥½
- âœ… æ”¯æŒå¤§è§„æ¨¡ä»»åŠ¡æ‰§è¡Œ

**ç¼ºç‚¹**ï¼š
- âŒ éœ€è¦ Kubernetes é›†ç¾¤ï¼ˆéƒ¨ç½²æˆæœ¬é«˜ï¼‰
- âš ï¸ YAML å®šä¹‰ï¼Œå¯è§†åŒ–ç¼–è¾‘èƒ½åŠ›æœ‰é™
- âš ï¸ å­¦ä¹ æ›²çº¿ä¸­ç­‰ï¼ˆéœ€è¦äº†è§£ K8sï¼‰
- âš ï¸ å¯¹éå®¹å™¨åŒ–åœºæ™¯ä¸å‹å¥½
- âš ï¸ å†…åµŒé›†æˆéœ€è¦è‡ªå·±å¼€å‘ç¼–è¾‘å™¨

**é€‚ç”¨åœºæ™¯**ï¼š
- âœ… å·²æœ‰ Kubernetes åŸºç¡€è®¾æ–½
- âœ… éœ€è¦å¤§è§„æ¨¡å¹¶è¡Œå¤„ç†
- âœ… å®¹å™¨åŒ–çš„æ•°æ®å¤„ç†æµç¨‹
- âœ… éœ€è¦ä¸ CI/CD é›†æˆ
- âœ… å›¢é˜Ÿç†Ÿæ‚‰ Kubernetes

---

### 4.3 æ–¹æ¡ˆ3ï¼šWindmillï¼ˆæ–°å…´é€‰æ‹© â­â­â­â­â­ï¼‰

#### 4.3.1 äº§å“ä»‹ç»

Windmill æ˜¯ä¸€ä¸ªå¿«é€Ÿçš„å¼€æºå·¥ä½œæµå¼•æ“å’Œå¼€å‘è€…å¹³å°ã€‚

**å®˜ç½‘**ï¼šhttps://www.windmill.dev/
**GitHub**ï¼šhttps://github.com/windmill-labs/windmill
**Star æ•°**ï¼š10k+
**ç‰¹ç‚¹**ï¼šå·ç§°æ¯” Airflow å¿« 13 å€

#### 4.3.2 æ ¸å¿ƒä¼˜åŠ¿

**1. æé€Ÿæ€§èƒ½**
- ç”¨ Rust ç¼–å†™ï¼Œæ€§èƒ½å“è¶Š
- æ¯” Airflow å¿« 13 å€
- é€‚åˆå¤§è§„æ¨¡æ•°æ®å¤„ç†

**2. å¼€å‘è€…å‹å¥½**
- æ”¯æŒ TypeScriptã€Pythonã€Goã€Bashã€SQLã€Rust
- ä»£ç å³å·¥ä½œæµ
- å†…ç½® IDE
- ç‰ˆæœ¬æ§åˆ¶é›†æˆ

**3. æ··åˆæ¨¡å¼**
- å¯è§†åŒ– + ä»£ç ç»“åˆ
- ä½ä»£ç æ„å»ºå™¨
- Pro-code æ”¯æŒ

**4. å¯åµŒå…¥**
- æä¾›å•†ä¸šè®¸å¯è¯
- REST API
- SDK æ”¯æŒ

#### 4.3.3 é›†æˆæ–¹å¼

**Python SDK**
```python
from windmill import client

# è¿æ¥åˆ° Windmill
wmill = client.Client(token="your-token")

# åˆ›å»ºå·¥ä½œæµ
wmill.create_flow({
    "summary": "Robot Data Pipeline",
    "value": {
        "modules": [
            {
                "id": "read_oss",
                "type": "script",
                "value": {
                    "language": "python",
                    "content": "# OSS è¯»å–è„šæœ¬"
                }
            },
            {
                "id": "transform",
                "type": "script",
                "value": {
                    "language": "python",
                    "content": "# æ•°æ®è½¬æ¢"
                }
            },
            {
                "id": "http_send",
                "type": "http",
                "value": {
                    "url": "https://api.example.com/data"
                }
            }
        ]
    }
})

# æ‰§è¡Œå·¥ä½œæµ
result = wmill.run_flow("robot-data-pipeline", {"oss_path": "..."})
```

**REST API**
```bash
# åˆ›å»ºè„šæœ¬
curl -X POST https://windmill.example.com/api/w/workspace/scripts/create \
  -H "Authorization: Bearer $TOKEN" \
  -d '{
    "path": "robot/read_oss",
    "language": "python3",
    "content": "import oss2\n# è¯»å–é€»è¾‘"
  }'

# æ‰§è¡Œè„šæœ¬
curl -X POST https://windmill.example.com/api/w/workspace/jobs/run/p/robot/read_oss \
  -H "Authorization: Bearer $TOKEN" \
  -d '{"oss_path": "bucket/data.json"}'
```

#### 4.3.4 ä¼˜ç¼ºç‚¹æ€»ç»“

**ä¼˜ç‚¹**ï¼š
- âœ… æ€§èƒ½æä½³ï¼Œé€‚åˆå¤§è§„æ¨¡å¤„ç†
- âœ… å¼€å‘è€…å‹å¥½ï¼Œå¤šè¯­è¨€æ”¯æŒ
- âœ… ç°ä»£åŒ–æ¶æ„
- âœ… å¯è§†åŒ– + ä»£ç çµæ´»ç»“åˆ

**ç¼ºç‚¹**ï¼š
- âš ï¸ ç¤¾åŒºç›¸å¯¹è¾ƒå°
- âš ï¸ å•†ä¸šåµŒå…¥éœ€è¦è®¸å¯è¯ï¼ˆè”ç³» sales@windmill.devï¼‰
- âš ï¸ å­¦ä¹ æ›²çº¿ç•¥é«˜äº n8n

---

### 4.4 æ–¹æ¡ˆ4ï¼šTemporalï¼ˆä¼ä¸šçº§ â­â­â­â­ï¼‰

#### 4.4.1 äº§å“ä»‹ç»

Temporal æ˜¯ä¸€ä¸ªå¼€æºçš„æŒä¹…åŒ–æ‰§è¡Œå¹³å°ï¼Œç”¨äºæ„å»ºå¯é çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚

**å®˜ç½‘**ï¼šhttps://temporal.io/
**GitHub**ï¼šhttps://github.com/temporalio/temporal
**ä½¿ç”¨è€…**ï¼šUberã€Netflixã€Stripe

#### 4.4.2 æ ¸å¿ƒä¼˜åŠ¿

**1. æŒä¹…åŒ–æ‰§è¡Œ**
- ä»»åŠ¡æ°¸ä¸ä¸¢å¤±
- è‡ªåŠ¨é‡è¯•æœºåˆ¶
- çŠ¶æ€è‡ªåŠ¨ä¿å­˜

**2. ä¼ä¸šçº§å¯é æ€§**
- ç»è¿‡å¤§è§„æ¨¡éªŒè¯
- åˆ†å¸ƒå¼æ¶æ„
- é«˜å¯ç”¨æ€§

**3. SDK é›†æˆ**
- Pythonã€Goã€Javaã€TypeScript
- åµŒå…¥åˆ°åº”ç”¨ä»£ç ä¸­
- ç±»å‹å®‰å…¨

#### 4.4.3 é›†æˆæ–¹å¼

**Python SDK**
```python
from temporalio import workflow, activity
from temporalio.client import Client
from temporalio.worker import Worker

# å®šä¹‰ Activity
@activity.defn
async def read_oss(oss_path: str) -> dict:
    import oss2
    # è¯»å– OSS æ–‡ä»¶
    return {"data": "..."}

@activity.defn
async def transform_data(data: dict) -> dict:
    # æ•°æ®è½¬æ¢
    return {"transformed": "..."}

@activity.defn
async def send_http(data: dict) -> dict:
    import httpx
    # å‘é€ HTTP
    return {"status": "sent"}

# å®šä¹‰ Workflow
@workflow.defn
class RobotDataWorkflow:
    @workflow.run
    async def run(self, oss_path: str) -> dict:
        # 1. è¯»å– OSS
        data = await workflow.execute_activity(
            read_oss,
            oss_path,
            start_to_close_timeout=timedelta(minutes=5)
        )

        # 2. è½¬æ¢æ•°æ®
        transformed = await workflow.execute_activity(
            transform_data,
            data,
            start_to_close_timeout=timedelta(minutes=2)
        )

        # 3. å‘é€ HTTP
        result = await workflow.execute_activity(
            send_http,
            transformed,
            start_to_close_timeout=timedelta(minutes=1)
        )

        return result

# åœ¨æ‚¨çš„å¹³å°ä¸­é›†æˆ
async def main():
    # è¿æ¥ Temporal Server
    client = await Client.connect("temporal-server:7233")

    # å¯åŠ¨ Workerï¼ˆåœ¨åå°æœåŠ¡ä¸­ï¼‰
    worker = Worker(
        client,
        task_queue="robot-data",
        workflows=[RobotDataWorkflow],
        activities=[read_oss, transform_data, send_http]
    )
    await worker.run()

    # åœ¨æ‚¨çš„ API ä¸­æ‰§è¡Œå·¥ä½œæµ
    result = await client.execute_workflow(
        RobotDataWorkflow.run,
        "oss://bucket/data.json",
        id="robot-data-" + str(uuid.uuid4()),
        task_queue="robot-data"
    )

    return result
```

#### 4.4.4 ä¼˜ç¼ºç‚¹æ€»ç»“

**ä¼˜ç‚¹**ï¼š
- âœ… ä¼ä¸šçº§å¯é æ€§
- âœ… æ°¸ä¸ä¸¢å¤±çš„ä»»åŠ¡æ‰§è¡Œ
- âœ… æˆç†Ÿçš„åˆ†å¸ƒå¼æ¶æ„
- âœ… å¤§å…¬å¸éªŒè¯

**ç¼ºç‚¹**ï¼š
- âŒ æ— å¯è§†åŒ–ç¼–è¾‘å™¨ï¼ˆçº¯ä»£ç ï¼‰
- âš ï¸ å­¦ä¹ æ›²çº¿é™¡å³­
- âš ï¸ éƒ¨ç½²å’Œç»´æŠ¤å¤æ‚
- âš ï¸ å¯¹äºç®€å•åœºæ™¯è¿‡åº¦è®¾è®¡

---

### 4.5 æ–¹æ¡ˆ5ï¼šPrefectï¼ˆPython å‹å¥½ â­â­â­â­ï¼‰

#### 4.5.1 äº§å“ä»‹ç»

Prefect æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„å·¥ä½œæµç¼–æ’å¹³å°ï¼ŒPython-first è®¾è®¡ã€‚

**å®˜ç½‘**ï¼šhttps://www.prefect.io/
**GitHub**ï¼šhttps://github.com/PrefectHQ/prefect

#### 4.5.2 æ ¸å¿ƒä¼˜åŠ¿

**1. Python-first**
- çº¯ Python ç¼–å†™å·¥ä½œæµ
- Pythonic API è®¾è®¡
- æ˜“äºæœ¬åœ°æµ‹è¯•

**2. ä¼˜é›…çš„ UI**
- ç°ä»£åŒ–çš„ Web ç•Œé¢
- å®æ—¶ç›‘æ§
- æ—¥å¿—å¯è§†åŒ–

**3. åŠ¨æ€å·¥ä½œæµ**
- å·¥ä½œæµå¯ä»¥åŠ¨æ€ç”Ÿæˆ
- å‚æ•°åŒ–æ”¯æŒ
- çµæ´»çš„è°ƒåº¦

#### 4.5.3 é›†æˆæ–¹å¼

```python
from prefect import flow, task
from prefect.deployments import Deployment
from prefect.server.schemas.schedules import CronSchedule

@task
def read_oss(oss_path: str):
    """è¯»å– OSS æ–‡ä»¶"""
    import oss2
    auth = oss2.Auth('access_key_id', 'access_key_secret')
    bucket = oss2.Bucket(auth, 'endpoint', 'bucket_name')

    obj = bucket.get_object(oss_path)
    return obj.read()

@task
def transform_data(data: bytes):
    """è½¬æ¢æ•°æ®"""
    import json
    raw_data = json.loads(data)

    # æ‚¨çš„è½¬æ¢é€»è¾‘
    transformed = {
        "robot_id": raw_data.get("id"),
        "sensors": raw_data.get("sensors"),
        "timestamp": raw_data.get("ts")
    }

    return transformed

@task
def send_http(data: dict):
    """å‘é€ HTTP è¯·æ±‚"""
    import httpx

    response = httpx.post(
        "https://api.example.com/data",
        json=data,
        headers={"Content-Type": "application/json"}
    )

    return response.json()

@flow(name="robot-data-pipeline")
def robot_data_pipeline(oss_path: str):
    """æœºå™¨äººæ•°æ®å¤„ç†æµç¨‹"""
    # 1. è¯»å– OSS
    raw_data = read_oss(oss_path)

    # 2. è½¬æ¢æ•°æ®
    transformed_data = transform_data(raw_data)

    # 3. å‘é€ HTTP
    result = send_http(transformed_data)

    return result

# éƒ¨ç½²å·¥ä½œæµ
if __name__ == "__main__":
    deployment = Deployment.build_from_flow(
        flow=robot_data_pipeline,
        name="robot-data-pipeline-prod",
        schedule=CronSchedule(cron="0 * * * *")  # æ¯å°æ—¶æ‰§è¡Œ
    )
    deployment.apply()
```

**åœ¨æ‚¨çš„å¹³å°ä¸­è°ƒç”¨**ï¼š
```python
from prefect.client import get_client
from prefect.deployments import run_deployment

async def trigger_workflow(oss_path: str):
    """åœ¨æ‚¨çš„å¹³å° API ä¸­è§¦å‘å·¥ä½œæµ"""
    async with get_client() as client:
        flow_run = await run_deployment(
            name="robot-data-pipeline/robot-data-pipeline-prod",
            parameters={"oss_path": oss_path}
        )
        return flow_run.id
```

#### 4.5.4 ä¼˜ç¼ºç‚¹æ€»ç»“

**ä¼˜ç‚¹**ï¼š
- âœ… Python ç”Ÿæ€ï¼Œæ•°æ®å›¢é˜Ÿå‹å¥½
- âœ… ç°ä»£åŒ– UI
- âœ… æ˜“äºæœ¬åœ°å¼€å‘å’Œæµ‹è¯•
- âœ… åŠ¨æ€å·¥ä½œæµæ”¯æŒ

**ç¼ºç‚¹**ï¼š
- âš ï¸ å¯è§†åŒ–ç¼–è¾‘æœ‰é™ï¼ˆä¸»è¦æ˜¯ä»£ç ï¼‰
- âš ï¸ å†…åµŒé›†æˆç›¸å¯¹å¤æ‚
- âš ï¸ ç¤¾åŒºè§„æ¨¡ä¸å¦‚ Airflow

---

## 5. æœ€ç»ˆæ¨èæ–¹æ¡ˆï¼šn8n

### 5.1 ä¸ºä»€ä¹ˆé€‰æ‹© n8nï¼Ÿ

åŸºäºæ‚¨çš„éœ€æ±‚åˆ†æï¼Œn8n æ˜¯æœ€ä½³é€‰æ‹©ï¼ŒåŸå› å¦‚ä¸‹ï¼š

#### 1. å®Œç¾åŒ¹é…éœ€æ±‚
- âœ… çœŸæ­£çš„å¯è§†åŒ–ç¼–è¾‘å™¨
- âœ… æ”¯æŒè‡ªå®šä¹‰è„šæœ¬ï¼ˆPython/JavaScriptï¼‰
- âœ… å†…ç½® HTTP èŠ‚ç‚¹
- âœ… å¯ä»¥å¼€å‘ OSS è‡ªå®šä¹‰èŠ‚ç‚¹

#### 2. å†…åµŒé›†æˆæœ€ç®€å•
- âœ… iframe ä¸€è¡Œä»£ç åµŒå…¥
- âœ… REST API å®Œæ•´
- âœ… å¯ä»¥ç™½æ ‡åŒ–
- âœ… éƒ¨ç½²ç®€å•

#### 3. ç”¨æˆ·å‹å¥½
- âœ… æ‹–æ‹½å¼æ“ä½œï¼Œå­¦ä¹ æˆæœ¬ä½
- âœ… äº§å“ç»ç†ã€æ•°æ®åˆ†æå¸ˆä¹Ÿèƒ½ç”¨
- âœ… å®æ—¶æµ‹è¯•å’Œè°ƒè¯•
- âœ… ç›´è§‚çš„æ•°æ®æµå±•ç¤º

#### 4. å¼€å‘è€…å‹å¥½
- âœ… è‡ªå®šä¹‰èŠ‚ç‚¹å¼€å‘ç®€å•
- âœ… ä»£ç èŠ‚ç‚¹æ”¯æŒ Python/JS
- âœ… ä¸°å¯Œçš„æ–‡æ¡£å’Œç¤ºä¾‹
- âœ… æ´»è·ƒçš„ç¤¾åŒº

#### 5. æˆæœ¬æ•ˆç›Šé«˜
- âœ… å¼€æºå…è´¹ï¼ˆFair-codeï¼‰
- âœ… éƒ¨ç½²ç»´æŠ¤æˆæœ¬ä½
- âœ… èµ„æºå ç”¨å°
- âœ… å¯ä»¥è‡ªæ‰˜ç®¡

### 5.2 n8n æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            æ‚¨çš„æœºå™¨äººæ•°æ®å¹³å°ï¼ˆå‰ç«¯ï¼‰                   â”‚
â”‚                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚        å·¥ä½œæµç®¡ç†é¡µé¢                        â”‚     â”‚
â”‚  â”‚                                             â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â”‚
â”‚  â”‚  â”‚     å·¥ä½œæµåˆ—è¡¨                     â”‚     â”‚     â”‚
â”‚  â”‚  â”‚  - Robot Sensor Data Pipeline    â”‚     â”‚     â”‚
â”‚  â”‚  â”‚  - Video Processing Workflow     â”‚     â”‚     â”‚
â”‚  â”‚  â”‚  - Log Analysis Pipeline         â”‚     â”‚     â”‚
â”‚  â”‚  â”‚  [+ æ–°å»ºå·¥ä½œæµ]                   â”‚     â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â”‚
â”‚  â”‚                                             â”‚     â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚     â”‚
â”‚  â”‚  â”‚   n8n å¯è§†åŒ–ç¼–è¾‘å™¨ (iframe)        â”‚     â”‚     â”‚
â”‚  â”‚  â”‚                                   â”‚     â”‚     â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â” â”‚     â”‚     â”‚
â”‚  â”‚  â”‚  â”‚ OSS  â”‚â†’â†’â†’â”‚Scriptâ”‚â†’â†’â†’â”‚ HTTP â”‚ â”‚     â”‚     â”‚
â”‚  â”‚  â”‚  â”‚Readerâ”‚   â”‚ Node â”‚   â”‚ Send â”‚ â”‚     â”‚     â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”˜ â”‚     â”‚     â”‚
â”‚  â”‚  â”‚                                   â”‚     â”‚     â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚     â”‚
â”‚  â”‚                                             â”‚     â”‚
â”‚  â”‚  [ğŸ’¾ ä¿å­˜]  [â–¶ï¸ æ‰§è¡Œ]  [ğŸ“Š æŸ¥çœ‹æ—¥å¿—]       â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“ REST API
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              æ‚¨çš„å¹³å°åç«¯ (Node.js/Python)             â”‚
â”‚                                                       â”‚
â”‚  - å·¥ä½œæµç®¡ç† API                                      â”‚
â”‚  - ç”¨æˆ·æƒé™æ§åˆ¶                                        â”‚
â”‚  - æ—¥å¿—èšåˆ                                           â”‚
â”‚  - æ•°æ®ç»Ÿè®¡                                           â”‚
â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“ è°ƒç”¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 n8n åç«¯æœåŠ¡                           â”‚
â”‚                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚         å·¥ä½œæµå¼•æ“                           â”‚     â”‚
â”‚  â”‚  - å·¥ä½œæµæ‰§è¡Œ                                â”‚     â”‚
â”‚  â”‚  - èŠ‚ç‚¹è°ƒåº¦                                  â”‚     â”‚
â”‚  â”‚  - çŠ¶æ€ç®¡ç†                                  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚         ä»»åŠ¡é˜Ÿåˆ— (Redis)                     â”‚     â”‚
â”‚  â”‚  - ä»»åŠ¡è°ƒåº¦                                  â”‚     â”‚
â”‚  â”‚  - å¹¶å‘æ§åˆ¶                                  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚         æ•°æ®å­˜å‚¨ (PostgreSQL)                â”‚     â”‚
â”‚  â”‚  - å·¥ä½œæµå®šä¹‰                                â”‚     â”‚
â”‚  â”‚  - æ‰§è¡Œå†å²                                  â”‚     â”‚
â”‚  â”‚  - æ—¥å¿—è®°å½•                                  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              å¤–éƒ¨ç³»ç»Ÿ                                  â”‚
â”‚                                                       â”‚
â”‚  - é˜¿é‡Œäº‘ OSS                                         â”‚
â”‚  - ç›®æ ‡ API ç«¯ç‚¹                                      â”‚
â”‚  - å…¶ä»–æ•°æ®æº                                         â”‚
â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.3 æ•°æ®æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         æœºå™¨äººæ•°æ®å¤„ç†å®Œæ•´æµç¨‹                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. è§¦å‘å·¥ä½œæµ
   â”œâ”€ å®šæ—¶è§¦å‘ï¼ˆCronï¼‰
   â”œâ”€ API è°ƒç”¨è§¦å‘
   â”œâ”€ Webhook è§¦å‘
   â””â”€ æ‰‹åŠ¨è§¦å‘
        â†“
2. OSS Reader èŠ‚ç‚¹
   â”œâ”€ è¿æ¥é˜¿é‡Œäº‘ OSS
   â”œâ”€ æ ¹æ®è·¯å¾„è¯»å–æ–‡ä»¶
   â”œâ”€ æ”¯æŒå¤šç§æ ¼å¼ï¼ˆJSON/CSV/äºŒè¿›åˆ¶ï¼‰
   â””â”€ è¾“å‡ºï¼šåŸå§‹æ•°æ®
        â†“
3. Data Validation èŠ‚ç‚¹ï¼ˆå¯é€‰ï¼‰
   â”œâ”€ éªŒè¯æ•°æ®æ ¼å¼
   â”œâ”€ æ£€æŸ¥å¿…å¡«å­—æ®µ
   â””â”€ è¾“å‡ºï¼šéªŒè¯ç»“æœ
        â†“
4. Script èŠ‚ç‚¹ï¼ˆPython/JavaScriptï¼‰
   â”œâ”€ è‡ªå®šä¹‰æ•°æ®è½¬æ¢é€»è¾‘
   â”œâ”€ æ ¼å¼è½¬æ¢
   â”œâ”€ æ•°æ®æ¸…æ´—
   â”œâ”€ è®¡ç®—æ´¾ç”Ÿå­—æ®µ
   â””â”€ è¾“å‡ºï¼šè½¬æ¢åçš„æ•°æ®
        â†“
5. IF/ELSE èŠ‚ç‚¹ï¼ˆå¯é€‰ï¼‰
   â”œâ”€ æ ¹æ®æ¡ä»¶åˆ†æ”¯
   â”œâ”€ é”™è¯¯å¤„ç†
   â””â”€ ä¸åŒæ•°æ®ç±»å‹ä¸åŒå¤„ç†
        â†“
6. HTTP Request èŠ‚ç‚¹
   â”œâ”€ POST åˆ°ç›®æ ‡ API
   â”œâ”€ è®¾ç½®è¯·æ±‚å¤´
   â”œâ”€ è¯·æ±‚ä½“æ ¼å¼åŒ–
   â””â”€ è¾“å‡ºï¼šAPI å“åº”
        â†“
7. Log èŠ‚ç‚¹
   â”œâ”€ è®°å½•æ‰§è¡Œæ—¥å¿—
   â”œâ”€ é”™è¯¯è¿½è¸ª
   â””â”€ æ€§èƒ½ç›‘æ§
        â†“
8. å®Œæˆ
   â””â”€ è¿”å›æ‰§è¡Œç»“æœ
```

---

## 6. å®æ–½æ–¹æ¡ˆ

### 6.1 ç¯å¢ƒå‡†å¤‡

#### 6.1.1 ç³»ç»Ÿè¦æ±‚
- **æœåŠ¡å™¨**ï¼š2 æ ¸ CPUã€4GB å†…å­˜ï¼ˆæœ€ä½é…ç½®ï¼‰
- **å­˜å‚¨**ï¼š20GBï¼ˆç”¨äºæ—¥å¿—å’Œæ•°æ®åº“ï¼‰
- **ç½‘ç»œ**ï¼šéœ€è¦è®¿é—®é˜¿é‡Œäº‘ OSS å’Œç›®æ ‡ API
- **åŸŸå**ï¼šå¯é€‰ï¼Œå»ºè®®é…ç½® HTTPS

#### 6.1.2 ä¾èµ–æœåŠ¡
- Docker & Docker Compose
- PostgreSQLï¼ˆæˆ–ä½¿ç”¨ SQLiteï¼‰
- Redisï¼ˆå¯é€‰ï¼Œç”¨äºé˜Ÿåˆ—ï¼‰

### 6.2 éƒ¨ç½² n8n

#### 6.2.1 ä½¿ç”¨ Docker Compose éƒ¨ç½²

åˆ›å»º `docker-compose.yml`ï¼š

```yaml
version: '3.8'

services:
  postgres:
    image: postgres:14
    restart: always
    environment:
      POSTGRES_DB: n8n
      POSTGRES_USER: n8n
      POSTGRES_PASSWORD: n8n_password
    volumes:
      - postgres_data:/var/lib/postgresql/data
    networks:
      - n8n-network

  redis:
    image: redis:7
    restart: always
    networks:
      - n8n-network

  n8n:
    image: n8nio/n8n:latest
    restart: always
    ports:
      - "5678:5678"
    environment:
      # æ•°æ®åº“é…ç½®
      - DB_TYPE=postgresdb
      - DB_POSTGRESDB_HOST=postgres
      - DB_POSTGRESDB_PORT=5432
      - DB_POSTGRESDB_DATABASE=n8n
      - DB_POSTGRESDB_USER=n8n
      - DB_POSTGRESDB_PASSWORD=n8n_password

      # æ‰§è¡Œæ¨¡å¼
      - EXECUTIONS_MODE=queue
      - QUEUE_BULL_REDIS_HOST=redis

      # åŸºç¡€é…ç½®
      - N8N_HOST=your-domain.com
      - N8N_PORT=5678
      - N8N_PROTOCOL=https
      - WEBHOOK_URL=https://your-domain.com/

      # å®‰å…¨é…ç½®
      - N8N_BASIC_AUTH_ACTIVE=true
      - N8N_BASIC_AUTH_USER=admin
      - N8N_BASIC_AUTH_PASSWORD=your_secure_password

      # API é…ç½®
      - N8N_API_KEY_AUTH_ENABLED=true

      # è‡ªå®šä¹‰èŠ‚ç‚¹è·¯å¾„
      - N8N_CUSTOM_EXTENSIONS=/home/node/.n8n/custom

      # æ—¶åŒº
      - GENERIC_TIMEZONE=Asia/Shanghai

    volumes:
      - n8n_data:/home/node/.n8n
      - ./custom-nodes:/home/node/.n8n/custom
    depends_on:
      - postgres
      - redis
    networks:
      - n8n-network

volumes:
  postgres_data:
  n8n_data:

networks:
  n8n-network:
    driver: bridge
```

#### 6.2.2 å¯åŠ¨æœåŠ¡

```bash
# å¯åŠ¨
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f n8n

# åœæ­¢
docker-compose down

# é‡å¯
docker-compose restart n8n
```

#### 6.2.3 é…ç½® Nginx åå‘ä»£ç†ï¼ˆå¯é€‰ï¼‰

```nginx
server {
    listen 80;
    server_name your-n8n-domain.com;

    # é‡å®šå‘åˆ° HTTPS
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name your-n8n-domain.com;

    # SSL è¯ä¹¦é…ç½®
    ssl_certificate /etc/ssl/certs/your-cert.pem;
    ssl_certificate_key /etc/ssl/private/your-key.pem;

    location / {
        proxy_pass http://localhost:5678;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_cache_bypass $http_upgrade;
    }
}
```

### 6.3 å¼€å‘ OSS è‡ªå®šä¹‰èŠ‚ç‚¹

#### 6.3.1 åˆ›å»ºèŠ‚ç‚¹ç›®å½•ç»“æ„

```
custom-nodes/
â””â”€â”€ nodes/
    â””â”€â”€ AliOss/
        â”œâ”€â”€ AliOss.node.ts
        â”œâ”€â”€ AliOss.node.json
        â””â”€â”€ ali-oss-icon.svg
```

#### 6.3.2 èŠ‚ç‚¹ä»£ç å®ç°

`AliOss.node.ts`ï¼š

```typescript
import {
    IExecuteFunctions,
    INodeExecutionData,
    INodeType,
    INodeTypeDescription,
} from 'n8n-workflow';

import OSS from 'ali-oss';

export class AliOss implements INodeType {
    description: INodeTypeDescription = {
        displayName: 'Ali OSS',
        name: 'aliOss',
        icon: 'file:ali-oss-icon.svg',
        group: ['transform'],
        version: 1,
        description: 'é˜¿é‡Œäº‘ OSS æ–‡ä»¶æ“ä½œ',
        defaults: {
            name: 'Ali OSS',
        },
        inputs: ['main'],
        outputs: ['main'],
        credentials: [
            {
                name: 'aliOssApi',
                required: true,
            },
        ],
        properties: [
            {
                displayName: 'Operation',
                name: 'operation',
                type: 'options',
                options: [
                    {
                        name: 'Get',
                        value: 'get',
                        description: 'è¯»å–æ–‡ä»¶',
                    },
                    {
                        name: 'Put',
                        value: 'put',
                        description: 'ä¸Šä¼ æ–‡ä»¶',
                    },
                    {
                        name: 'List',
                        value: 'list',
                        description: 'åˆ—å‡ºæ–‡ä»¶',
                    },
                ],
                default: 'get',
            },
            {
                displayName: 'Bucket',
                name: 'bucket',
                type: 'string',
                default: '',
                required: true,
                description: 'OSS Bucket åç§°',
            },
            {
                displayName: 'Object Path',
                name: 'objectPath',
                type: 'string',
                default: '',
                displayOptions: {
                    show: {
                        operation: ['get', 'put'],
                    },
                },
                description: 'æ–‡ä»¶è·¯å¾„ï¼ˆä¾‹å¦‚ï¼šdata/robot-sensor.jsonï¼‰',
            },
            {
                displayName: 'Prefix',
                name: 'prefix',
                type: 'string',
                default: '',
                displayOptions: {
                    show: {
                        operation: ['list'],
                    },
                },
                description: 'æ–‡ä»¶å‰ç¼€ï¼ˆç”¨äºè¿‡æ»¤ï¼‰',
            },
            {
                displayName: 'Output Format',
                name: 'outputFormat',
                type: 'options',
                options: [
                    {
                        name: 'JSON',
                        value: 'json',
                    },
                    {
                        name: 'Text',
                        value: 'text',
                    },
                    {
                        name: 'Binary',
                        value: 'binary',
                    },
                ],
                default: 'json',
                displayOptions: {
                    show: {
                        operation: ['get'],
                    },
                },
            },
        ],
    };

    async execute(this: IExecuteFunctions): Promise<INodeExecutionData[][]> {
        const items = this.getInputData();
        const returnData: INodeExecutionData[] = [];

        // è·å–å‡­è¯
        const credentials = await this.getCredentials('aliOssApi');

        // åˆ›å»º OSS å®¢æˆ·ç«¯
        const client = new OSS({
            accessKeyId: credentials.accessKeyId as string,
            accessKeySecret: credentials.accessKeySecret as string,
            region: credentials.region as string,
            bucket: this.getNodeParameter('bucket', 0) as string,
        });

        const operation = this.getNodeParameter('operation', 0) as string;

        for (let i = 0; i < items.length; i++) {
            try {
                if (operation === 'get') {
                    // è¯»å–æ–‡ä»¶
                    const objectPath = this.getNodeParameter('objectPath', i) as string;
                    const outputFormat = this.getNodeParameter('outputFormat', i) as string;

                    const result = await client.get(objectPath);

                    let data;
                    if (outputFormat === 'json') {
                        data = JSON.parse(result.content.toString());
                    } else if (outputFormat === 'text') {
                        data = result.content.toString();
                    } else {
                        data = result.content;
                    }

                    returnData.push({
                        json: {
                            objectPath,
                            size: result.res.size,
                            lastModified: result.res.headers['last-modified'],
                            data,
                        },
                    });

                } else if (operation === 'put') {
                    // ä¸Šä¼ æ–‡ä»¶
                    const objectPath = this.getNodeParameter('objectPath', i) as string;
                    const content = items[i].json.content || items[i].binary;

                    const result = await client.put(objectPath, Buffer.from(content));

                    returnData.push({
                        json: {
                            objectPath,
                            url: result.url,
                            etag: result.etag,
                        },
                    });

                } else if (operation === 'list') {
                    // åˆ—å‡ºæ–‡ä»¶
                    const prefix = this.getNodeParameter('prefix', i) as string;

                    const result = await client.list({
                        prefix,
                        'max-keys': 100,
                    });

                    returnData.push({
                        json: {
                            objects: result.objects,
                            prefixes: result.prefixes,
                        },
                    });
                }
            } catch (error) {
                if (this.continueOnFail()) {
                    returnData.push({
                        json: {
                            error: error.message,
                        },
                    });
                    continue;
                }
                throw error;
            }
        }

        return [returnData];
    }
}
```

#### 6.3.3 å‡­è¯é…ç½®

`credentials/AliOssApi.credentials.ts`ï¼š

```typescript
import {
    ICredentialType,
    INodeProperties,
} from 'n8n-workflow';

export class AliOssApi implements ICredentialType {
    name = 'aliOssApi';
    displayName = 'Ali OSS API';
    documentationUrl = 'https://help.aliyun.com/document_detail/32027.html';
    properties: INodeProperties[] = [
        {
            displayName: 'Access Key ID',
            name: 'accessKeyId',
            type: 'string',
            default: '',
            required: true,
        },
        {
            displayName: 'Access Key Secret',
            name: 'accessKeySecret',
            type: 'string',
            typeOptions: {
                password: true,
            },
            default: '',
            required: true,
        },
        {
            displayName: 'Region',
            name: 'region',
            type: 'string',
            default: 'oss-cn-hangzhou',
            description: 'OSS åŒºåŸŸï¼ˆä¾‹å¦‚ï¼šoss-cn-hangzhouï¼‰',
        },
    ];
}
```

#### 6.3.4 å®‰è£…ä¾èµ–

åœ¨ custom-nodes ç›®å½•ä¸‹åˆ›å»º `package.json`ï¼š

```json
{
  "name": "n8n-nodes-ali-oss",
  "version": "1.0.0",
  "description": "n8n nodes for Aliyun OSS",
  "main": "index.js",
  "n8n": {
    "nodes": [
      "nodes/AliOss/AliOss.node.js"
    ],
    "credentials": [
      "credentials/AliOssApi.credentials.js"
    ]
  },
  "dependencies": {
    "ali-oss": "^6.17.1"
  }
}
```

å®‰è£…ï¼š
```bash
cd custom-nodes
npm install
npm run build
```

### 6.4 å‰ç«¯é›†æˆ

#### 6.4.1 React ç»„ä»¶ç¤ºä¾‹

```typescript
// WorkflowEditor.tsx
import React, { useEffect, useState } from 'react';
import axios from 'axios';

interface WorkflowEditorProps {
    workflowId?: string;
    onSave?: (workflowId: string) => void;
}

const WorkflowEditor: React.FC<WorkflowEditorProps> = ({ workflowId, onSave }) => {
    const [iframeUrl, setIframeUrl] = useState('');
    const [loading, setLoading] = useState(false);

    useEffect(() => {
        if (workflowId) {
            // ç¼–è¾‘ç°æœ‰å·¥ä½œæµ
            setIframeUrl(`${process.env.REACT_APP_N8N_URL}/workflow/${workflowId}`);
        } else {
            // åˆ›å»ºæ–°å·¥ä½œæµ
            setIframeUrl(`${process.env.REACT_APP_N8N_URL}/workflow/new`);
        }
    }, [workflowId]);

    // ç›‘å¬ iframe æ¶ˆæ¯
    useEffect(() => {
        const handleMessage = (event: MessageEvent) => {
            if (event.origin !== process.env.REACT_APP_N8N_URL) return;

            if (event.data.type === 'workflow-saved') {
                const savedWorkflowId = event.data.workflowId;
                if (onSave) {
                    onSave(savedWorkflowId);
                }
            }
        };

        window.addEventListener('message', handleMessage);
        return () => window.removeEventListener('message', handleMessage);
    }, [onSave]);

    return (
        <div className="workflow-editor-container">
            <div className="editor-toolbar">
                <h2>{workflowId ? 'ç¼–è¾‘å·¥ä½œæµ' : 'åˆ›å»ºå·¥ä½œæµ'}</h2>
                <button onClick={() => window.history.back()}>è¿”å›</button>
            </div>

            {loading && <div className="loading">åŠ è½½ä¸­...</div>}

            <iframe
                src={iframeUrl}
                width="100%"
                height="800px"
                frameBorder="0"
                style={{ border: 'none' }}
                onLoad={() => setLoading(false)}
            />
        </div>
    );
};

export default WorkflowEditor;
```

#### 6.4.2 å·¥ä½œæµåˆ—è¡¨ç»„ä»¶

```typescript
// WorkflowList.tsx
import React, { useEffect, useState } from 'react';
import { useNavigate } from 'react-router-dom';
import { workflowService } from '../services/workflow';

interface Workflow {
    id: string;
    name: string;
    active: boolean;
    createdAt: string;
    updatedAt: string;
}

const WorkflowList: React.FC = () => {
    const [workflows, setWorkflows] = useState<Workflow[]>([]);
    const [loading, setLoading] = useState(true);
    const navigate = useNavigate();

    useEffect(() => {
        loadWorkflows();
    }, []);

    const loadWorkflows = async () => {
        try {
            const data = await workflowService.getAll();
            setWorkflows(data);
        } catch (error) {
            console.error('åŠ è½½å·¥ä½œæµå¤±è´¥:', error);
        } finally {
            setLoading(false);
        }
    };

    const handleExecute = async (workflowId: string) => {
        try {
            await workflowService.execute(workflowId);
            alert('å·¥ä½œæµå·²è§¦å‘æ‰§è¡Œ');
        } catch (error) {
            alert('æ‰§è¡Œå¤±è´¥');
        }
    };

    const handleDelete = async (workflowId: string) => {
        if (!confirm('ç¡®å®šè¦åˆ é™¤è¿™ä¸ªå·¥ä½œæµå—ï¼Ÿ')) return;

        try {
            await workflowService.delete(workflowId);
            loadWorkflows();
        } catch (error) {
            alert('åˆ é™¤å¤±è´¥');
        }
    };

    if (loading) return <div>åŠ è½½ä¸­...</div>;

    return (
        <div className="workflow-list">
            <div className="list-header">
                <h2>å·¥ä½œæµç®¡ç†</h2>
                <button onClick={() => navigate('/workflows/new')}>
                    + åˆ›å»ºå·¥ä½œæµ
                </button>
            </div>

            <table className="workflow-table">
                <thead>
                    <tr>
                        <th>åç§°</th>
                        <th>çŠ¶æ€</th>
                        <th>æ›´æ–°æ—¶é—´</th>
                        <th>æ“ä½œ</th>
                    </tr>
                </thead>
                <tbody>
                    {workflows.map(workflow => (
                        <tr key={workflow.id}>
                            <td>{workflow.name}</td>
                            <td>
                                <span className={workflow.active ? 'status-active' : 'status-inactive'}>
                                    {workflow.active ? 'æ¿€æ´»' : 'æœªæ¿€æ´»'}
                                </span>
                            </td>
                            <td>{new Date(workflow.updatedAt).toLocaleString()}</td>
                            <td>
                                <button onClick={() => navigate(`/workflows/${workflow.id}`)}>
                                    ç¼–è¾‘
                                </button>
                                <button onClick={() => handleExecute(workflow.id)}>
                                    æ‰§è¡Œ
                                </button>
                                <button onClick={() => navigate(`/workflows/${workflow.id}/logs`)}>
                                    æ—¥å¿—
                                </button>
                                <button onClick={() => handleDelete(workflow.id)}>
                                    åˆ é™¤
                                </button>
                            </td>
                        </tr>
                    ))}
                </tbody>
            </table>
        </div>
    );
};

export default WorkflowList;
```

### 6.5 åç«¯ API æœåŠ¡

#### 6.5.1 Node.js æœåŠ¡ç¤ºä¾‹

```typescript
// src/services/n8n.service.ts
import axios, { AxiosInstance } from 'axios';

export class N8nService {
    private client: AxiosInstance;

    constructor() {
        this.client = axios.create({
            baseURL: process.env.N8N_API_URL || 'http://localhost:5678/api/v1',
            headers: {
                'X-N8N-API-KEY': process.env.N8N_API_KEY,
                'Content-Type': 'application/json',
            },
        });
    }

    // è·å–æ‰€æœ‰å·¥ä½œæµ
    async getAllWorkflows() {
        const response = await this.client.get('/workflows');
        return response.data.data;
    }

    // è·å–å•ä¸ªå·¥ä½œæµ
    async getWorkflow(workflowId: string) {
        const response = await this.client.get(`/workflows/${workflowId}`);
        return response.data;
    }

    // åˆ›å»ºå·¥ä½œæµ
    async createWorkflow(workflow: any) {
        const response = await this.client.post('/workflows', workflow);
        return response.data;
    }

    // æ›´æ–°å·¥ä½œæµ
    async updateWorkflow(workflowId: string, workflow: any) {
        const response = await this.client.patch(`/workflows/${workflowId}`, workflow);
        return response.data;
    }

    // åˆ é™¤å·¥ä½œæµ
    async deleteWorkflow(workflowId: string) {
        await this.client.delete(`/workflows/${workflowId}`);
    }

    // æ‰§è¡Œå·¥ä½œæµ
    async executeWorkflow(workflowId: string, data?: any) {
        const response = await this.client.post(`/workflows/${workflowId}/execute`, {
            data,
        });
        return response.data;
    }

    // è·å–æ‰§è¡Œå†å²
    async getExecutions(workflowId: string, limit = 20) {
        const response = await this.client.get('/executions', {
            params: {
                workflowId,
                limit,
            },
        });
        return response.data.data;
    }

    // è·å–å•ä¸ªæ‰§è¡Œè¯¦æƒ…
    async getExecution(executionId: string) {
        const response = await this.client.get(`/executions/${executionId}`);
        return response.data;
    }

    // æ¿€æ´»/åœç”¨å·¥ä½œæµ
    async toggleWorkflowActive(workflowId: string, active: boolean) {
        const response = await this.client.patch(`/workflows/${workflowId}`, {
            active,
        });
        return response.data;
    }
}

export const n8nService = new N8nService();
```

#### 6.5.2 Express API è·¯ç”±

```typescript
// src/routes/workflow.routes.ts
import { Router } from 'express';
import { n8nService } from '../services/n8n.service';
import { authMiddleware } from '../middleware/auth';

const router = Router();

// åº”ç”¨è®¤è¯ä¸­é—´ä»¶
router.use(authMiddleware);

// è·å–æ‰€æœ‰å·¥ä½œæµ
router.get('/workflows', async (req, res) => {
    try {
        const workflows = await n8nService.getAllWorkflows();
        res.json({
            success: true,
            data: workflows,
        });
    } catch (error) {
        res.status(500).json({
            success: false,
            error: error.message,
        });
    }
});

// è·å–å•ä¸ªå·¥ä½œæµ
router.get('/workflows/:id', async (req, res) => {
    try {
        const workflow = await n8nService.getWorkflow(req.params.id);
        res.json({
            success: true,
            data: workflow,
        });
    } catch (error) {
        res.status(500).json({
            success: false,
            error: error.message,
        });
    }
});

// åˆ›å»ºå·¥ä½œæµ
router.post('/workflows', async (req, res) => {
    try {
        const workflow = await n8nService.createWorkflow(req.body);
        res.json({
            success: true,
            data: workflow,
        });
    } catch (error) {
        res.status(500).json({
            success: false,
            error: error.message,
        });
    }
});

// æ›´æ–°å·¥ä½œæµ
router.put('/workflows/:id', async (req, res) => {
    try {
        const workflow = await n8nService.updateWorkflow(req.params.id, req.body);
        res.json({
            success: true,
            data: workflow,
        });
    } catch (error) {
        res.status(500).json({
            success: false,
            error: error.message,
        });
    }
});

// åˆ é™¤å·¥ä½œæµ
router.delete('/workflows/:id', async (req, res) => {
    try {
        await n8nService.deleteWorkflow(req.params.id);
        res.json({
            success: true,
        });
    } catch (error) {
        res.status(500).json({
            success: false,
            error: error.message,
        });
    }
});

// æ‰§è¡Œå·¥ä½œæµ
router.post('/workflows/:id/execute', async (req, res) => {
    try {
        const result = await n8nService.executeWorkflow(req.params.id, req.body);
        res.json({
            success: true,
            data: result,
        });
    } catch (error) {
        res.status(500).json({
            success: false,
            error: error.message,
        });
    }
});

// è·å–æ‰§è¡Œå†å²
router.get('/workflows/:id/executions', async (req, res) => {
    try {
        const limit = parseInt(req.query.limit as string) || 20;
        const executions = await n8nService.getExecutions(req.params.id, limit);
        res.json({
            success: true,
            data: executions,
        });
    } catch (error) {
        res.status(500).json({
            success: false,
            error: error.message,
        });
    }
});

// æ¿€æ´»/åœç”¨å·¥ä½œæµ
router.patch('/workflows/:id/active', async (req, res) => {
    try {
        const { active } = req.body;
        const workflow = await n8nService.toggleWorkflowActive(req.params.id, active);
        res.json({
            success: true,
            data: workflow,
        });
    } catch (error) {
        res.status(500).json({
            success: false,
            error: error.message,
        });
    }
});

export default router;
```

---

## 7. å®Œæ•´ç¤ºä¾‹

### 7.1 ç¤ºä¾‹å·¥ä½œæµï¼šæœºå™¨äººä¼ æ„Ÿå™¨æ•°æ®å¤„ç†

#### 7.1.1 éœ€æ±‚æè¿°
- æ¯å°æ—¶ä» OSS è¯»å–æœºå™¨äººä¼ æ„Ÿå™¨æ•°æ®
- æ•°æ®æ ¼å¼è½¬æ¢å’Œæ¸…æ´—
- è®¡ç®—ç»Ÿè®¡æŒ‡æ ‡
- å‘é€åˆ°æ•°æ®åˆ†æå¹³å°

#### 7.1.2 å·¥ä½œæµå®šä¹‰ï¼ˆJSONï¼‰

```json
{
  "name": "Robot Sensor Data Pipeline",
  "nodes": [
    {
      "id": "trigger",
      "type": "n8n-nodes-base.cron",
      "parameters": {
        "triggerTimes": {
          "item": [
            {
              "mode": "everyHour"
            }
          ]
        }
      },
      "position": [250, 300],
      "name": "Hourly Trigger"
    },
    {
      "id": "oss-reader",
      "type": "n8n-nodes-custom.aliOss",
      "parameters": {
        "operation": "get",
        "bucket": "robot-data-bucket",
        "objectPath": "sensors/{{$now.format('YYYY-MM-DD-HH')}}.json",
        "outputFormat": "json"
      },
      "position": [450, 300],
      "name": "Read Sensor Data"
    },
    {
      "id": "validate",
      "type": "n8n-nodes-base.code",
      "parameters": {
        "language": "javascript",
        "code": "// éªŒè¯æ•°æ®æ ¼å¼\nconst data = items[0].json.data;\n\nif (!Array.isArray(data)) {\n  throw new Error('Invalid data format');\n}\n\n// è¿‡æ»¤æ— æ•ˆæ•°æ®\nconst validData = data.filter(item => {\n  return item.robot_id && \n         item.timestamp && \n         item.sensors &&\n         typeof item.sensors.temperature === 'number' &&\n         typeof item.sensors.battery === 'number';\n});\n\nreturn [{ json: { data: validData } }];"
      },
      "position": [650, 300],
      "name": "Validate Data"
    },
    {
      "id": "transform",
      "type": "n8n-nodes-base.code",
      "parameters": {
        "language": "python",
        "code": "# æ•°æ®è½¬æ¢å’Œè®¡ç®—\nimport json\nfrom datetime import datetime\nimport statistics\n\ndata = items[0]['json']['data']\n\n# æŒ‰æœºå™¨äººåˆ†ç»„\nrobot_stats = {}\n\nfor record in data:\n    robot_id = record['robot_id']\n    \n    if robot_id not in robot_stats:\n        robot_stats[robot_id] = {\n            'robot_id': robot_id,\n            'temperatures': [],\n            'batteries': [],\n            'record_count': 0\n        }\n    \n    robot_stats[robot_id]['temperatures'].append(record['sensors']['temperature'])\n    robot_stats[robot_id]['batteries'].append(record['sensors']['battery'])\n    robot_stats[robot_id]['record_count'] += 1\n\n# è®¡ç®—ç»Ÿè®¡æŒ‡æ ‡\nresults = []\nfor robot_id, stats in robot_stats.items():\n    results.append({\n        'robot_id': robot_id,\n        'timestamp': datetime.now().isoformat(),\n        'stats': {\n            'avg_temperature': statistics.mean(stats['temperatures']),\n            'max_temperature': max(stats['temperatures']),\n            'min_temperature': min(stats['temperatures']),\n            'avg_battery': statistics.mean(stats['batteries']),\n            'min_battery': min(stats['batteries']),\n            'record_count': stats['record_count']\n        }\n    })\n\nreturn [{'json': {'results': results}}]"
      },
      "position": [850, 300],
      "name": "Transform & Calculate"
    },
    {
      "id": "alert-check",
      "type": "n8n-nodes-base.if",
      "parameters": {
        "conditions": {
          "boolean": [
            {
              "value1": "={{$json.stats.min_battery}}",
              "operation": "smaller",
              "value2": 20
            }
          ]
        }
      },
      "position": [1050, 300],
      "name": "Low Battery Alert?"
    },
    {
      "id": "send-alert",
      "type": "n8n-nodes-base.httpRequest",
      "parameters": {
        "method": "POST",
        "url": "https://api.example.com/alerts",
        "jsonParameters": true,
        "options": {},
        "bodyParametersJson": "={\n  \"type\": \"low_battery\",\n  \"robot_id\": \"{{$json.robot_id}}\",\n  \"battery\": {{$json.stats.min_battery}},\n  \"timestamp\": \"{{$json.timestamp}}\"\n}"
      },
      "position": [1250, 200],
      "name": "Send Alert"
    },
    {
      "id": "send-data",
      "type": "n8n-nodes-base.httpRequest",
      "parameters": {
        "method": "POST",
        "url": "https://api.example.com/analytics/robot-stats",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "jsonParameters": true,
        "options": {},
        "bodyParametersJson": "={{$json}}"
      },
      "position": [1250, 400],
      "name": "Send to Analytics"
    },
    {
      "id": "log",
      "type": "n8n-nodes-base.code",
      "parameters": {
        "language": "javascript",
        "code": "console.log('Pipeline completed:', {\n  timestamp: new Date().toISOString(),\n  recordsProcessed: items.length\n});\n\nreturn items;"
      },
      "position": [1450, 300],
      "name": "Log Result"
    }
  ],
  "connections": {
    "trigger": {
      "main": [[{"node": "oss-reader", "type": "main", "index": 0}]]
    },
    "oss-reader": {
      "main": [[{"node": "validate", "type": "main", "index": 0}]]
    },
    "validate": {
      "main": [[{"node": "transform", "type": "main", "index": 0}]]
    },
    "transform": {
      "main": [[{"node": "alert-check", "type": "main", "index": 0}]]
    },
    "alert-check": {
      "main": [
        [{"node": "send-alert", "type": "main", "index": 0}],
        [{"node": "send-data", "type": "main", "index": 0}]
      ]
    },
    "send-alert": {
      "main": [[{"node": "send-data", "type": "main", "index": 0}]]
    },
    "send-data": {
      "main": [[{"node": "log", "type": "main", "index": 0}]]
    }
  },
  "active": true,
  "settings": {
    "timezone": "Asia/Shanghai"
  }
}
```

### 7.2 ä½¿ç”¨ API åˆ›å»ºå·¥ä½œæµ

```typescript
// åœ¨æ‚¨çš„å¹³å°åç«¯åˆ›å»ºå·¥ä½œæµ
import { n8nService } from './services/n8n.service';

async function createRobotSensorPipeline() {
    const workflow = {
        name: 'Robot Sensor Data Pipeline',
        nodes: [
            // ... èŠ‚ç‚¹å®šä¹‰ï¼ˆå¦‚ä¸Šï¼‰
        ],
        connections: {
            // ... è¿æ¥å®šä¹‰ï¼ˆå¦‚ä¸Šï¼‰
        },
        active: true,
    };

    try {
        const created = await n8nService.createWorkflow(workflow);
        console.log('å·¥ä½œæµåˆ›å»ºæˆåŠŸ:', created.id);
        return created;
    } catch (error) {
        console.error('åˆ›å»ºå¤±è´¥:', error);
        throw error;
    }
}

// æ‰§è¡Œå·¥ä½œæµ
async function triggerPipeline(ossPath: string) {
    const workflowId = 'your-workflow-id';

    try {
        const result = await n8nService.executeWorkflow(workflowId, {
            ossPath,
        });

        console.log('æ‰§è¡ŒæˆåŠŸ:', result);
        return result;
    } catch (error) {
        console.error('æ‰§è¡Œå¤±è´¥:', error);
        throw error;
    }
}
```

---

## 8. æ€»ç»“ä¸å»ºè®®

### 8.1 æ–¹æ¡ˆæ€»ç»“

åŸºäºæœºå™¨äººæ•°æ®å¹³å°çš„éœ€æ±‚ï¼Œæˆ‘ä»¬æ¨èä½¿ç”¨ **n8n** ä½œä¸ºå·¥ä½œæµå¼•æ“ï¼š

#### æ ¸å¿ƒä¼˜åŠ¿
1. âœ… **å¯è§†åŒ–ç¼–è¾‘**ï¼šçœŸæ­£çš„æ‹–æ‹½å¼æ“ä½œï¼Œé™ä½ä½¿ç”¨é—¨æ§›
2. âœ… **æ˜“äºé›†æˆ**ï¼šiframe åµŒå…¥ + REST APIï¼Œé›†æˆç®€å•
3. âœ… **çµæ´»æ‰©å±•**ï¼šè‡ªå®šä¹‰èŠ‚ç‚¹å¼€å‘å®¹æ˜“ï¼Œå¯åˆ›å»º OSS èŠ‚ç‚¹
4. âœ… **æˆæœ¬ä½**ï¼šå¼€æºå…è´¹ï¼Œéƒ¨ç½²ç»´æŠ¤ç®€å•
5. âœ… **ç¤¾åŒºæ´»è·ƒ**ï¼š400+ èŠ‚ç‚¹ï¼Œæ–‡æ¡£å®Œå–„

#### å®æ–½è·¯å¾„
1. **Phase 1**ï¼šéƒ¨ç½² n8n å¹¶å¼€å‘ OSS è‡ªå®šä¹‰èŠ‚ç‚¹
2. **Phase 2**ï¼šå‰ç«¯é›†æˆï¼Œå®ç°å¯è§†åŒ–ç¼–è¾‘å™¨åµŒå…¥
3. **Phase 3**ï¼šåç«¯ API å°è£…ï¼Œç»Ÿä¸€ç®¡ç†å·¥ä½œæµ
4. **Phase 4**ï¼šåˆ›å»ºå¸¸ç”¨å·¥ä½œæµæ¨¡æ¿ï¼Œæ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨

### 8.2 å¤‡é€‰æ–¹æ¡ˆ

å¦‚æœæœ‰ç‰¹æ®Šéœ€æ±‚ï¼Œå¯ä»¥è€ƒè™‘ï¼š

**Argo Workflows**ï¼š
- é€‚åˆï¼šå·²æœ‰ Kubernetes åŸºç¡€è®¾æ–½çš„å›¢é˜Ÿ
- ä¼˜åŠ¿ï¼šäº‘åŸç”Ÿã€é«˜æ€§èƒ½ã€CNCF æ¯•ä¸šé¡¹ç›®
- åŠ£åŠ¿ï¼šéœ€è¦ K8s ç¯å¢ƒï¼ŒYAML å®šä¹‰ä¸ºä¸»

**Windmill**ï¼š
- é€‚åˆï¼šå¼€å‘å›¢é˜ŸæŠ€æœ¯èƒ½åŠ›å¼ºï¼Œéœ€è¦é«˜æ€§èƒ½
- ä¼˜åŠ¿ï¼šé€Ÿåº¦å¿«ï¼Œå¤šè¯­è¨€æ”¯æŒï¼Œä»£ç +å¯è§†åŒ–ç»“åˆ

**Temporal**ï¼š
- é€‚åˆï¼šå¯¹å¯é æ€§è¦æ±‚æé«˜çš„ä¼ä¸šçº§åœºæ™¯
- ä¼˜åŠ¿ï¼šæ°¸ä¸ä¸¢å¤±çš„ä»»åŠ¡æ‰§è¡Œï¼Œå¤§å…¬å¸éªŒè¯

**Prefect**ï¼š
- é€‚åˆï¼šPython æŠ€æœ¯æ ˆçš„æ•°æ®å›¢é˜Ÿ
- ä¼˜åŠ¿ï¼šPython å‹å¥½ï¼Œæ˜“äºæµ‹è¯•ï¼Œç°ä»£åŒ– UI

### 8.3 ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç¯å¢ƒæ­å»º**
   - [ ] å‡†å¤‡æœåŠ¡å™¨èµ„æº
   - [ ] éƒ¨ç½² n8nï¼ˆDocker Composeï¼‰
   - [ ] é…ç½®åŸŸåå’Œ HTTPS

2. **èŠ‚ç‚¹å¼€å‘**
   - [ ] å¼€å‘é˜¿é‡Œäº‘ OSS è‡ªå®šä¹‰èŠ‚ç‚¹
   - [ ] æµ‹è¯•èŠ‚ç‚¹åŠŸèƒ½
   - [ ] ç¼–å†™èŠ‚ç‚¹ä½¿ç”¨æ–‡æ¡£

3. **å‰ç«¯é›†æˆ**
   - [ ] å¼€å‘å·¥ä½œæµç®¡ç†é¡µé¢
   - [ ] é›†æˆ n8n ç¼–è¾‘å™¨ï¼ˆiframeï¼‰
   - [ ] å®ç°å·¥ä½œæµåˆ—è¡¨å’Œæ‰§è¡Œæ—¥å¿—

4. **åç«¯ API**
   - [ ] å°è£… n8n API
   - [ ] å®ç°æƒé™æ§åˆ¶
   - [ ] æ—¥å¿—èšåˆå’Œç›‘æ§

5. **æµ‹è¯•ä¸Šçº¿**
   - [ ] åˆ›å»ºç¤ºä¾‹å·¥ä½œæµ
   - [ ] ç”¨æˆ·åŸ¹è®­
   - [ ] ç›‘æ§å’Œä¼˜åŒ–

### 8.4 æŠ€æœ¯æ”¯æŒ

å¦‚éœ€è¿›ä¸€æ­¥å¸®åŠ©ï¼Œå¯ä»¥ï¼š

1. **n8n å®˜æ–¹èµ„æº**
   - æ–‡æ¡£ï¼šhttps://docs.n8n.io/
   - ç¤¾åŒºï¼šhttps://community.n8n.io/
   - GitHubï¼šhttps://github.com/n8n-io/n8n

2. **é˜¿é‡Œäº‘ OSS SDK**
   - æ–‡æ¡£ï¼šhttps://help.aliyun.com/document_detail/32027.html
   - Node.js SDKï¼šhttps://github.com/ali-sdk/ali-oss

3. **æœ¬æ–‡æ¡£ç›¸å…³**
   - æä¾›å®Œæ•´çš„éƒ¨ç½²è„šæœ¬
   - æä¾›è‡ªå®šä¹‰èŠ‚ç‚¹å¼€å‘ç¤ºä¾‹
   - æä¾›å‰åç«¯é›†æˆä»£ç 

---

**æ–‡æ¡£ç»“æŸ**

æœ¬æ–¹æ¡ˆå¯æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´å’Œä¼˜åŒ–ã€‚